<div class="container">
  <div class="row justify-content-center">
    <div class="cards col-8 d-flex flex-row mx-auto p-4 mt-5">
      <div class="p-3">
        <%= cl_image_tag @bookclub.photo.key, height: 140, width: 140, class: "rounded-circle  shadow" %>
      </div>
      <div class="d-flex flex-column ms-5">
        <div class="mt-3">
      <div class="text-end">
        <% if @bookclub.bookclub_members.find_by(user: current_user)&.admin? %>
          <p class="text-end">Host</p>
        <% end %>
      </div>
          <h5><strong><%= @bookclub.name %></strong></h5>
          <p class="num-members"><%= @bookclub.bookclub_members.size %> members</p>
        </div>
        <div class="mt-4">
          <p> <%= @bookclub.description %> </p>
        </div>
      </div>
    </div>
  </div>
  <div>
    <% if @current_meeting.nil? %>
      <div class="cards col-8 mx-auto my-5">
        <div class= "d-flex justify-content-around align-items-center">
          <h3 class="d-flex justify-content-center py-4">Currently not reading</h3>
          <%= link_to "New meeting", new_bookclub_meeting_path(@bookclub), class: "button" %>
        </div>
        <% if policy(Meeting.new(bookclub: @bookclub)).new? %>
          <p class="text-center pb-4"><strong>Meeting details</strong></p>
        <% end %>
      </div>
    <% else %>
      <div>
        <% if @book.present? %>
          <div class="cards col-8 d-flex mx-auto p-4 mt-5">
            <div class="ps-3 pt-3">
              <%= image_tag @book.image_link, height: 200, class: "shadow mb-3" %>
            </div>
            <div class="d-flex flex-column">
              <div class="d-flex flex-column">
                <div class="ms-5 mt-3">
                  <%= @book.title %>
                </div>
                <div class="ms-5 mt-1">
                  <%= @book.author %>
                </div>
                <div class="ms-5 mt-1">
                  <%= @book.year %>
                </div>
              </div>
              <div class="mx-5 mt-5 mb-3">
                <%= @book.description %>
              </div>
            </div>
          </div>
        <% end %>
        <div class="cards col-8 d-flex flex-column mx-auto p-4 my-5 mx-3">
          <div class="d-flex justify-content-between">
            <% if policy(Meeting.new(bookclub: @bookclub)).new? %>
              <p><strong>Meeting details</strong></p>
              <%= link_to "New meeting", new_bookclub_meeting_path(@bookclub), class: "button" %>
            <% end %>
          </div>
          <div class="d-flex mt-4 mb-4 justify-content-between align-items-center">
            <div>
              <% if @current_meeting.present? %>
                <div>
                  <%= @current_meeting.location %>
                </div>
                <div>
                  <%= @current_meeting.video_link %>
                </div>
                <div>
                  <%= @current_meeting.date_time %>
                </div>
              </div>
              <div class="d-flex">
                <% if @current_meeting.pending? %>
                  <div class="d-flex">
                    <%= link_to "yes", meeting_accept_path(@current_meeting), data: {turbo_method: :post}, class: "button-meet mx-2" %>
                    <%= link_to "no", meeting_decline_path(@current_meeting), data: {turbo_method: :post}, class: "button-meet" %>
                  </div>
                <% elsif @current_meeting.declined? %>
                  <div class="d-flex">
                    <div class="button-meet mx-3">declined</div>
                  </div>
                <% else @current_meeting.accepted? %>
                  <div class="d-flex">
                    <div class="button-meet mx-3">accepted</div>
                  </div>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
